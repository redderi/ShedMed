# SchedMed

SchedMed — десктопное приложение для медицинских учреждений, предназначенное для учёта медицинского оборудования и управления графиком поверочных событий. Оно позволяет вести базу данных оборудования, отслеживать даты калибровок, выполнять поиск, экспортировать и импортировать данные в Excel и PDF, а также создавать резервные копии.

## Возможности

- **Управление оборудованием**: Добавление, редактирование и удаление записей об оборудовании (наименование, серийный номер, интервал калибровки, даты поверок, местоположение и др.).
- **Калибровочные события**: Создание, редактирование и удаление событий поверки.
- **Поиск и сортировка**: Быстрый поиск с фильтрацией по колонкам и сортировкой данных.
- **Импорт/экспорт**: Поддержка форматов Excel (`.xlsx`) и PDF.
- **Резервное копирование**: Создание и восстановление резервных копий базы данных.
- **Интерфейс**: Удобный GUI с переносом текста в заголовках таблиц (`CustomHeaderView`), контекстными меню и сохранением ширины колонок.

## Технологии

- **Язык**: Python 3.8+
- **GUI**: PySide6
- **База данных**: SQLite (SQLAlchemy)
- **Импорт/экспорт**: openpyxl (Excel), pdfplumber и reportlab (PDF)

## Установка

### Из исходного кода

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/redderi/SchedMed.git
   cd SchedMed
   ```

2. Создайте виртуальное окружение:
   ```bash
   python -m venv venv
   source venv/bin/activate  # Linux/macOS
   venv\Scripts\activate     # Windows
   ```

3. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
   Содержимое `requirements.txt`:
   ```text
    altgraph==0.17.4
    cffi==1.17.1
    chardet==5.2.0
    charset-normalizer==3.4.2
    cryptography==45.0.4
    et_xmlfile==2.0.0
    greenlet==3.2.3
    openpyxl==3.1.5
    packaging==25.0
    pdfminer.six==20250506
    pdfplumber==0.11.7
    pefile==2023.2.7
    pillow==11.2.1
    pycparser==2.22
    pyinstaller==6.14.1
    pyinstaller-hooks-contrib==2025.5
    pypdfium2==4.30.1
    PySide6==6.9.1
    PySide6_Addons==6.9.1
    PySide6_Essentials==6.9.1
    pywin32-ctypes==0.2.3
    reportlab==4.4.1
    setuptools==80.9.0
    shiboken6==6.9.1
    SQLAlchemy==2.0.41
    typing_extensions==4.14.0
   ```

4. Запустите приложение:
   ```bash
   python main.py
   ```

### Из исполняемого файла

1. Скачайте установщик `SchedMedSetup.exe` из [Releases](https://github.com/redderi/SchedMed/releases).
2. Запустите установщик и следуйте инструкциям.
3. Откройте приложение через ярлык на рабочем столе или в меню «Пуск».


## Использование

1. **Запуск**: Откройте приложение. Главное окно включает вкладки **Главная** (оборудование) и **События** (поверки).
2. **Добавление оборудования**:
   - Нажмите **Создать** на вкладке **Главная**.
   - Заполните обязательные поля: Наименование, Серийный номер, Интервал калибровки, Дата последней калибровки.
   - Нажмите **Сохранить**.
3. **Поиск**: Введите запрос в поле поиска, выберите колонку или «Все колонки».
4. **Экспорт/импорт**:
   - **Экспорт**: Нажмите **Экспорт**, выберите Excel или PDF, укажите путь.
   - **Импорт**: Нажмите **Импорт**, выберите файл, укажите режим (добавить/заменить).
5. **Резервное копирование**: Нажмите **Резервные копии** для создания или восстановления архива.
6. **Контекстное меню**: Щёлкните правой кнопкой на строке таблицы для действий: Изменить, Удалить, Отметить поверку сегодня.

Подробности см. в [Руководстве пользователя](res/user_guide/user_guide.html).

## Сборка

### PyInstaller

1. Установите PyInstaller:
   ```bash
   pip install pyinstaller
   ```

2. Выполните команду:
   ```bash
    pyinstaller \
    --onefile \
    --windowed \
    --name "SchedMed" \
    --icon="../res/icons/icon.ico" \
    --add-data "../res;res" \
    main.py
   ```

3. Исполняемый файл будет в `dist/`.

### Inno Setup

1. Установите [Inno Setup](https://jrsoftware.org/isdl.php).
2. Откройте `installer.iss` в Inno Setup Compiler.  
3. Скомпилируйте для создания `SchedMedSetup.exe`.

## Лицензия

SchedMed распространяется под [MIT License](LICENSE).